# Plaintext credentials in the filesystem

- CVE ID: CVE-2025-25985
- CVSS3.1 vector: AV:L/AC:L/PR:H/UI:N/S:C/C:L/I:N/A:N
- CVSS3.1 score: 3.2 (Low)
- CWE-256: Plaintext Storage of a Password

> Alternative vector exists with lower CVSS score but different attack conditions:
> - CVSS3.1 vector: AV:P/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
> - CVSS3.1 score: 2.6 (Low)

### Summary:

Macro-video Technologies Co.,Ltd V380E6_C1 IP camera (hardware id: Hw_HsAKPIQp_WF_XHR) was discovered to store plaintext Wi-Fi and user credentials in the filesystem on the flash memory.
This vulnerability allows attackers with physical access to the device or root shell access to access those credentials.

### Details:

Plaintext credentials were discovered:

- Wi-Fi credentials are stored in `/mnt/mtd/mvconf/wifi.ini` file on the flash memory chip.
- Camera user credentials are stored in `/mnt/mtd/mvconf/user_info.ini` file on the flash memory chip.

Contents of those files can be accessed in two ways:

- Using linux commands in the root shell of the device
- Reading flash chip contents using a programmer

The Winbond flash chip is located on the bottom of the board and can be read in place with a clip when the camera is disabled.

Similar filesystem structure was observed on some other devices working with the V380 app.

![Winbond flash chip on the board](/images/bottom.jpg)

### Proof of Concept:

#### Using root shell:

- Gain root shell access (e.g. through [CVE-2025-25984](/CVE-2025-25984.md))
- Run `cat /mnt/mtd/mvconf/wifi.ini /mnt/mtd/mvconf/user_info.ini` command
- Verify credentials being displayed

#### Using programmer:

- Turn off the device and disconnect the USB power cable
- Disassemble the device
- Use a programmer with a clip to read the contents of the flash chip
- Extract the files from the dump (e.g. using `binwalk`)
- Verify credentials being present in the files

### Impact:

An attacker with physical access or root shell access can gain access to plaintext credentials.
This allows the attacker to perform credential stuffing attacks as well as gain access to the Wi-Fi network.

### Affected products:

- V380E6_C1 IP camera (hardware id: Hw_HsAKPIQp_WF_XHR)
- Possibly, other cameras working with V380 application

### Recommendation for vendor:

Use recommendations for [CVE-2025-25984](/CVE-2025-25984.md) to prevent root shell access.

Add a hardware security module to encrypt credentials. This will prevent physical attacks.

Store the hash of the camera user password instead of the hash itself.
Hash the provided password on the camera and check if it matches the stored hash.

### Recommendation for customers:

- Use recommendations for [CVE-2025-25984](/CVE-2025-25984.md) to prevent root shell access
- Control physical access to the camera to prevent attackers from interacting with the device
- Use unique randomly generated credentials for each camera to protect against credential stuffing attacks
- Use a separate Wi-Fi hotspot in a separate network for the cameras, treat that network as external.

### Rationale for CVSS assessment:

#### Main vector

- Attack Vector: Local
> Any root shell access would allow an attacker to obtain the credentials.
- Attack Complexity: Low
> Attacker can obtain the credentials without any external requirements beyond attacker's control.
- Privileges Required: High
> Root shell access grants full control over the camera, even higher than the administrative access.
- User Interaction: None
> User interaction is not required to exploit the vulnerability.
- Scope: Changed
> The vulnerability allows the attacker to obtain plaintext credentials for further credential stuffing attacks on other systems.
> The vulnerability also allows the attacker to obtain Wi-Fi credentials.
- Confidentiality Impact: Low
> User credentials by themselves are confidential, but they do not pose immediate significant impact.
> Wi-Fi credentials provide more impact, so it can be altered to (`Confidentiality Impact: High`)
- Integrity Impact: None
> Credentials leak by a highly privileged attacker does not affect integrity.
- Availability Impact: None
> Credentials leak by a highly privileged attacker does not affect availability.

#### Alternative vector

- Attack Vector: Physical
> Physical access is required to interract with the flash chip.
> Flas chip is not reachable, unless the camera is disassembled.
- Attack Complexity: Low
> Attacker can obtain the credentials without any external requirements beyond attacker's control.
> Cameras are often located in hard to reach places, monitor their own surroundings and take time to disassemble, so it might be altered to `Attack Complexity: High`.
- Privileges Required: None
> Physical access to the contents of the flash chip does not require any privileges.
- User Interaction: None
> User interaction is not required to exploit the vulnerability.
- Scope: Changed
> The vulnerability allows the attacker to obtain plaintext credentials for further credential stuffing attacks on other systems.
> The vulnerability also allows the attacker to obtain Wi-Fi credentials.
- Confidentiality Impact: Low
> User credentials by themselves are confidential, but they do not pose immediate significant impact.
> Wi-Fi credentials provide more impact, so it can be altered to (`Confidentiality Impact: High`)
- Integrity Impact: None
> Credentials leak by an attacker with physical access does not affect integrity.
- Availability Impact: None
> Credentials leak by an attacker with physical access does not affect availability.

### Timeline:

- 11.01.2025 - Vulnerability discovered
- 19.01.2025 - Vulnerability reported to vendor, no meaningful reply
- 26.01.2025 - CVE ID requested
- 13.02.2025 - Received CVE ID: CVE-2025-25985
- 22.02.2025 - Second attempt to contact vendor, providing CVE ID and disclosure date
- 13.04.2025 - Responsible disclosure