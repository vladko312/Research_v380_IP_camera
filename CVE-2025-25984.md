# Root shell accessible over UART with hardcoded password

- CVE ID: CVE-2025-25984
- CVSS3.1 vector: AV:P/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
- CVSS3.1 score: 6.8 (Medium)
- CWE-259: Use of Hard-coded Password

### Summary:

Macro-video Technologies Co.,Ltd V380E6_C1 IP camera (hardware id: Hw_HsAKPIQp_WF_XHR) was discovered to contain hardcoded root credentials stored in read-only filesystem on the flash memory.
This vulnerability allows attackers with physical access to the device to gain root shell access via UART.

### Details:

The password hash for the `root` user is located in `/etc/shadow` on the squashfs (read-only) partition of the flash chip.
The password is `gzhongshi` and it was known for some time by the modding community.

```
$1$abc123lk$QG3JmuRFzSVpv99ers92a/ : gzhongshi
```

UART access requires disassembling the camera.

Dedicated UART test pads are disabled, but other test pads near the CPU expose the UART interface.

Both the password and the hash were observed on some other devices working with the V380 app.

### Proof of Concept:

I got wires soldered to test pads on my camera, so I have no image of the original board state.

Disassemble the device and connect to the UART interface of the camera using test pads near the CPU:

- Device GND (USB-C shielding, white wire on the picture) to the GND on the UART adapter
- Device TX (behind the resistor, green wire on the picture) to the RX on the UART adapter
- Device RX (close to the edge, red wire on the picture) to TX on the UART adapter

Press enter to get the login prompt.

Enter login `root` and password `gzhongshi`.

Use Linux commands such as `id` or `whoami` to verify root shell access.

![Wires soldered to UART test pads](/images/top.jpg)

### Impact:

An attacker with physical access can gain full control over the camera.
This allows the attacker to :

- view/modify/delete recordings
- view/alter/disrupt video feed
- access/alter configuration files
- create backdoors and remote access capabilities
- use camera to get access to the local network

It might be also possible to control PTZ on other cameras, but my camera has no PTZ to begin with.

### Affected products:

- V380E6_C1 IP camera (hardware id: Hw_HsAKPIQp_WF_XHR)
- Possibly, other cameras working with V380 application

### Recommendation for vendor:

It is possible to fix the vulnerability without significant changes to the manufacturing process:

- Generate unique random password for the camera
- Create `shadow` file with the password hash (similar to the current `/etc/shadow` on the camera)
- Put the file into the JFFS2 partition (that is mounted to `/mnt/mtd/` on the camera)
- Add a bind mount command to the end of `nvipcstart.sh` (or any other shell script used during boot):

```shell
mount -o bind /mnt/mtd/shadow /etc/shadow
```

- Optionally, provide the password to the user (in case the user wants to change something)

This will allow the unique password to be used without altering the constant squashfs partition.
Unique values are already written to the JFFS2 partition (e.g. camera ID).

It is also recommended to:
- Alter `/etc/passwd` in a similar way to change shell for `root` to `/bin/nologin`
- Disable UART to prevent physical shell access

### Recommendation for customers:

- Generate unique random password for the camera.
- Create `md5crypt` hash of that password.
- Get root shell access as described in the [Proof of Concept](#proof-of-concept) section
- Run `cp /etc/shadow /mnt/mtd/shadow` command
- Use `vi /mnt/mtd/shadow` to edit the file
- Press `i` and then replace the hash from the [Details](#details) section with your hash
- Press Esc, type `:wq` and press enter to exit the editor
- Use `vi /mnt/mtd/nvipcstart.sh` to edit the file
- Press `i` and then add `mount -o bind /mnt/mtd/shadow /etc/shadow` to the end of the file
- Press Esc, type `:wq` and press enter to exit the editor
- Run `mount -o bind /mnt/mtd/shadow /etc/shadow` command
- Reboot the camera and check that you can log in over UART using the new password

It is also recommended to control physical access to the camera to prevent attackers from interacting with the device.

### Rationale for CVSS assessment:

- Attack Vector: Physical
> By default, root shell is accessible only with physical connection over UART.
> UART test pads are not reachable, unless the camera is disassembled.
- Attack Complexity: Low
> Attacker can use the hardcoded password without any external requirements beyond attacker's control.
> Cameras are often located in hard to reach places, monitor their own surroundings and take time to disassemble, so it might be altered to `Attack Complexity: High`.
- Privileges Required: None
> Access to the root shell over UART with a hardcoded password does not require any privileges.
- User Interaction: None
> User interaction is not required to exploit the vulnerability.
- Scope: Unchanged
> The vulnerability only directly affects the camera itself.
> Post exploitation is possible, so it might be altered to `Scope: Changed`.
- Confidentiality Impact: High
> Root access allows viewing live camera feed and recorded videos.
- Integrity Impact: High
> Root access allows altering recordings as well as replacing the software to alter the live video.
- Availability Impact: High
> Root access allows stopping software and deleting files to disrupt any camera functions.

### Timeline:

- 11.01.2025 - Vulnerability discovered
- 19.01.2025 - Vulnerability reported to vendor, no meaningful reply
- 26.01.2025 - CVE ID requested
- 13.02.2025 - Received CVE ID: CVE-2025-25984
- 22.02.2025 - Second attempt to contact vendor, providing CVE ID and disclosure date
- 13.04.2025 - Responsible disclosure